/*! Resultados Digitais - Thu Jul 02 2020 18:39:29 GMT-0300 (Brasilia Standard Time) */
"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RDStationFormIntegration(e,n,t){RdIntegration.integrate(e,n,t)}var FormFields=function(){function e(e){for(var n=[],t=0;t<e.length;t+=1)n.push(e[t]);return n}function n(e){var n=jQuery(e).attr("name")||"",t=e.value,r=RDIntegrationCreditCard.validNumber(t);return!(u.indexOf(n.toLowerCase())>=0||r)}function t(t){var r=jQuery(t).find(":input").not(":password"),o=e(r),i=o.filter(n);return jQuery(i).serializeArray()}function r(e){return e.replace(/[\s_-]/g,"").toLowerCase().indexOf("email")>-1}function o(e){var n=!1,t=e.type;return t&&(n="email"===t),r(e.name)||n}function i(e){var n=!1;return jQuery.each(e,function(){if(o(this)&&""!==this.value)return this.name="email",n=!0,!1}),n}function a(t){return e(jQuery(t).find(":input").not(":password").not(":submit").not(":button").not(":reset").not(":checkbox").not(":radio")).filter(n)}var u=["captcha","_wpcf7","_wpcf7_version","_wpcf7_unit_tag","_wpnonce","_wpcf7_is_ajax_call","_wpcf7_locale","g-recaptcha-response","_viewstate","_previouspage","_viewstategenerator","payment.creditcardholdercpf","payment.creditcardexpirationmonth","payment.creditcardexpirationyear","payment.creditcardsecuritycode","payment.creditcardholder","payment.creditcardtype"];return{findEmail:i,singleFields:a,retrieveAllowedFields:t}}(),RDErrorNotifier=function(){function e(n,t){_classCallCheck(this,e),this.requestStatus=n,this.requestBody=t}return _createClass(e,[{key:"notify",value:function(){var e=JSON.stringify({status:this.requestStatus,body:this.requestBody});jQuery.ajax({type:"POST",url:this.URL,data:e,dataType:"json",crossDomain:!0})}}]),e}();RDErrorNotifier.prototype.URL="https://qtmlugypw3.execute-api.us-east-1.amazonaws.com/production";var RDIntegrationCreditCard=function(){function e(e){var n,t,r,o=0,i=0;if("string"!=typeof e)return!1;if(t=e.replace(/\D/g,""),(r=t.length)<14)return!1;for(;r--;)n=parseInt(t.charAt(r),10)<<i,o+=n-9*(n>9),i^=1;return o%10==0&&o>0}return{validNumber:e}}();"undefined"!=typeof module&&module.hasOwnProperty("exports")&&(module.exports=RDIntegrationCreditCard);var FieldMapping=function(){function e(){l=[]}function n(e){var n,t,r=e.getAttribute("name"),o=/\[/g,i=/\]/g;return!!r&&(n=r.replace(o,"_"),t=n.replace(i,""),"checkbox"===e.type?"".concat(t,"[]"):t)}function t(e){var n=jQuery('label[for="'+e.id+'"]')[0],t=jQuery(e).closest("label")[0],r=n||t;return!!r&&r.innerText.trim()}function r(e,r){var o=r.getAttribute("type"),i="Field "+e+" "+o;return n(r)||t(r)||r.getAttribute("id")||i}function o(e){jQuery(e).map(function(e,n){return l.push({name:r(e,n),value:n.value,type:n.type}),!1})}function i(e){o(FormFields.singleFields(e[0]))}function a(e){var n=e.find(":checkbox:checked[name]").clone();n.each(function(e,n){n.name=n.name.split(".")[0]}),o(n)}function u(e){o(e.find(":radio:checked"))}function c(n){return e(),i(n),a(n),u(n),l}var l=[];return{mapFields:c}}(),RdIntegrationIdentifier=function(){function e(e){var n=e[0].action;return"object"===_typeof(n)?n.value:void 0!==n?n:""}function n(n){var t,r=!1,o=["squarespace.com","realty_ajax_shortcode_contact_form"];for(t=0;t<o.length;t+=1)e(n).indexOf(o[t])>-1&&(r=!0);return r}function t(e){return!n(e)&&e.attr("id")}function r(e){var n="/"===window.location.pathname?"home":window.location.pathname;return e.attr("name")||t(e)||n}return{identifier:r}}(),RdIntegration=function(){var e,n,t,r,o,i,a=function(e){"undefined"==typeof jQuery?l("https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js",e):e()},u=function(e,n,t){a(function(){i=jQuery,c(e,n,t),f(),S()})},c=function(e,o,i){r=i||{},n=e,t=o},l=function(e,n){var t=document.getElementsByTagName("head")[0],r=document.createElement("script");r.type="text/javascript",r.src=e,r.onload=n,r.onreadystatechange=function(){"complete"===this.readyState&&n()},t.appendChild(r)},f=function(){i(":submit").click(s)},s=function(n){if(o=h(),e=d(n.target)){var t=FormFields.retrieveAllowedFields(e);if(FormFields.findEmail(t)){var r=m(t);("function"!=typeof e[0].checkValidity||e[0].checkValidity())&&(R(r,g),n.preventDefault())}}},d=function(e){return i(e).closest("form:not([data-internal-rdstation-form])")},m=function(e){var n=p(e);return n.push(o.identifier,o.token,b()),n},p=function(e){return r.fieldMapping&&(e=y(e)),e},y=function(e){return i.each(e,function(){var e=r.fieldMapping[this.name];e&&(this.name=e)}),e},g=function(){v(e)?e.submit():e.find(":submit").unbind("click",s).click()},v=function(e){var n=e.attr("action");return void 0!==n&&""!==n.trim()},h=function(){return{identifier:{name:"identificador",value:t},token:{name:"token_rdstation",value:n}}},_=function(e){var n,t,r=document.cookie.split(";");for(e+="=",n=0;n<r.length;n++){for(t=r[n];" "===t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(e))return t.substring(e.length,t.length)}return null},b=function(){return{name:"query_params",value:location.search.substring(1)}},w=function(){var e=_("rdtrk");if(null!==e)return e=JSON.parse(unescape(e)),e.id},j=function(e){var n=w();return void 0!==n&&e.push({name:"client_id",value:n}),e},F=function(e){var n=_("__utmz"),t=_("__trf.src");return n&&e.push({name:"c_utmz",value:n}),t&&e.push({name:"traffic_source",value:t}),e},C=function(e){console.log("insert browser privacy values");var n;return window.RDCookieControl.userInteracted&&(n={analytics:window.RDCookieControl.analytics.track,functional:window.RDCookieControl.functional.track,banner_type:window.RDCookieControl.configuration.type},e.push({name:"privacy_data[browser]",value:JSON.stringify(n)})),console.log(e),e},k=function(e,n){return e.push({name:"_is",value:n}),e},R=function(e,n,t){var r,o;t=t||3,r=10===t?"form-integrations":"conversions",e=j(e),e=F(e),e=k(e,t),e=C(e),a(function(){jQuery.ajax({type:"POST",url:"http://localhost:3000/api/1.3/"+r,data:e,crossDomain:!0,xhrFields:{withCredentials:!0},warn:function(e){console.log("ERROR - "),console.log(e)},complete:function(t,r){if(t.status>=500)return o=new RDErrorNotifier(t.status,e),void o.notify();n&&n(t,r)},beforeSend:function(){}})})},S=function(){!0===r.debugMode&&x()},x=function(){a(function(){i=jQuery,r=r||{},console.info("Iniciando");var e=i(_getElementSubmit()),n=d(e);0===e.length?console.warn("Nenhum botao de submit encontrado"):console.info("Botoes de submit encontrados: "+e.length),0===n.length?console.warn("Nenhum formulario encontrado"):console.info("Formularios encontrados: "+n.length),I(n),console.info("Finalizado")})},I=function(e){o=h(),i.each(e,function(e,n){var t=m(n),r=[];console.log(""),console.info(e+1+" formulario"),FormFields.findEmail(n)?console.info("Campo de email encontrado"):console.warn("Campo de email nao encontrado"),i.each(t,function(e,n){r.push(n.name)}),console.info("Campos mapeados: "+r.join(", "))}),console.log("")},D=function(e,t){r=t||{},n=e,a(function(){localStorage.getItem("RdIntegrationFormData")&&A(),Q()})},Q=function(){var e=jQuery('form:not(:has(input[name="internal_source"],input[name="_is"]))');jQuery(e).submit(O)},O=function(e){var n=jQuery(e.target).closest("form"),r=FieldMapping.mapFields(n);FormFields.findEmail(r)&&(t=RdIntegrationIdentifier.identifier(n),N(r))},N=function(e){e=E(e),q(e),R(e,function(e){P(e)},10)},E=function(e){return e.push({name:"identificador",value:t},{name:"token_rdstation",value:n},{name:"form_url",value:location.href.split("?")[0]},{name:"page_title",value:document.title}),e},q=function(e){localStorage.setItem("RdIntegrationFormData",JSON.stringify(e))},A=function(){var e=JSON.parse(localStorage.getItem("RdIntegrationFormData"));R(e,function(e){P(e)},10)},P=function(e){4===e.readyState&&localStorage.removeItem("RdIntegrationFormData")};return{integrate:u,post:R,analyse:x,integrateAll:D}}();